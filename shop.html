<!DOCTYPE html>
<html lang="zh-Hant-TW">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@100..900&display=swap" rel="stylesheet">
    
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <!-- 引用ShopFilter元件 -->
    <script type="text/babel" src="./ShopFilter.jsx"></script>
    <title>SHOP 經典商品</title>
    <!-- 引用menu -->
    <link rel="stylesheet" href="./css/Menu.css">
    <script type="text/babel" src="./Menu.jsx"></script>
    <script src="./js/Menu.js"></script>
    <!-- 引用swiper -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css" />
    <link rel="stylesheet" href="./css/shop.css">

</head>

<body>
    <div id="menu"></div>
    <script type="text/babel">
        function App() {
            React.useEffect(() => {
                menuJS();
            }, []); // 确保 toggleDropdown 在组件渲染后调用
            return (
                <Menu />
            )
        }
        ReactDOM
            .createRoot(document.getElementById('menu'))
            .render(<App />);
    </script>
    <header></header>
    <main>

        <div id="bannerCycle"></div>
        <script type="text/babel">

            const { useEffect } = React;

            function App() {

                useEffect(() => {

                    const swiper = new Swiper('.swiper', {
                        // Swiper 設定選項
                        loop: true, // 無限循環模式
                        autoplay: {
                            delay: 5000, // 自動輪播時間，單位是毫秒
                        },
                        speed: 800, // 變化過渡動畫持續 600 毫秒
                        navigation: {
                            nextEl: '.swiper-button-next',
                            prevEl: '.swiper-button-prev',
                        },
                        scrollbar: {
                            el: '.swiper-scrollbar',
                            hide: true,
                        },
                        // If we need pagination
                        pagination: {
                            el: '.swiper-pagination',
                        },
                    });

                }, []);

                return (<>

                    <div className="swiper" >
                        <div className="swiper-wrapper">
                            <div className="swiper-slide">
                                <img src="./images/shop_images/shop_banner.jpg" alt="" />
                            </div>
                            <div className="swiper-slide">
                                <img src="./images/shop_images/shop_banner2.jpg" alt="" />
                            </div>
                        </div>
                        {/* pagination */}
                        <div className="swiper-pagination"></div>
 
                    </div>

                </>)
            }

            ReactDOM
                .createRoot(document.querySelector('#bannerCycle'))
                .render(<App />)
        </script>




        <div id="root"></div>



        <script type="text/babel">

            function Item(props) {
                /* 由item.id指定new標籤所顯示的指定商品項目 */
                const newItemIds = ['2', '4', '5', '7', '13', '14'];
                return (
                    <div className="item_wrap">
                        <a className="item" href="./Product_details_page.html">
                            {/* 檢查 id 是否在 newItemIds 列表中 */}
                            {newItemIds.includes(props.id) && (
                                <img className="new_tag" src="./images/shop_images/item_new.svg" alt="New" />
                            )}
                            <div className="item_pic"> <img src={props.pic} /></div>
                            <div className="item_name">{props.name}</div>
                            <div className="item_price">NT {props.price}</div>
                            <div className="item_text">{props.text}</div>
                        </a>
                    </div>)
            }

            const App = () => {




                const items = [
                    {
                        id: '1',
                        counts: '12',
                        pic: './images/shop_images/item1.jpg',
                        name: '黃金典雅禮盒12入',
                        price: '1,800',
                        text: '這款黃金典雅禮盒內含精選巧克力，包裝豪華，適合送禮自用皆宜，展現品味與高貴。'
                    },
                    {
                        id: '2',
                        counts: '12',
                        pic: './images/shop_images/item2.jpg',
                        name: '手工奢華巧克力禮盒12入',
                        price: '2,600',
                        text: '每顆巧克力皆由大師手工製作，結合頂級原料，讓您體驗無可比擬的奢華口感。'
                    },
                    {
                        id: '3',
                        counts: '24',
                        pic: './images/shop_images/item3.jpg',
                        name: '璀璨星河禮盒24入',
                        price: '2,800',
                        text: '璀璨星河禮盒帶來星光般的美麗，內含精緻巧克力，每一口都充滿浪漫與驚喜。'
                    },
                    {
                        id: '4',
                        counts: '12',
                        pic: './images/shop_images/item4.jpg',
                        name: '璀璨七夕-情人節禮盒',
                        price: '3,000',
                        text: '專為情人節設計的璀璨禮盒，展現愛意，巧克力的每一口都彷彿融化在心中。',
                        fes: 'valentines'
                    },
                    {
                        id: '5',
                        counts: '12',
                        pic: './images/shop_images/item5-1.jpg',
                        name: '熱戀之吻-情人節禮盒',
                        price: '3,000',
                        text: '熱戀之吻巧克力禮盒，特別為情人節打造，甜美的巧克力表達最深情的告白。',
                        fes: 'valentines'
                    },
                    {
                        id: '6',
                        counts: '12',
                        pic: './images/shop_images/item6.jpg',
                        name: '90%黑金巧克力禮盒',
                        price: '2,500',
                        text: '90%高濃度黑巧克力，帶來深邃的苦甜風味，滿足對巧克力的高標準需求。'
                    },
                    {
                        id: '7',
                        counts: '12',
                        pic: './images/shop_images/item7.jpg',
                        name: '生日快樂-巧克力禮盒',
                        price: '1,800',
                        text: '為生日精心準備的巧克力禮盒，充滿甜蜜和祝福，讓每一口都帶來快樂與驚喜。',
                        fes: 'birthday'
                    },
                    {
                        id: '8',
                        counts: '12',
                        pic: './images/shop_images/item8.jpg',
                        name: '摩卡經典禮盒12入',
                        price: '1,000',
                        text: '摩卡風味巧克力禮盒，結合濃郁咖啡香與細膩巧克力，帶來獨特的品味體驗。'
                    },
                    {
                        id: '9',
                        counts: '12',
                        pic: './images/shop_images/item9.jpg',
                        name: '麋鹿聖誕-巧克力禮盒',
                        price: '3,000',
                        text: '聖誕節限定巧克力禮盒，精緻設計與美味巧克力，增添節日的歡樂與喜悅。',
                        fes: 'otherDays'
                    }, {
                        id: '10',
                        counts: '4',
                        pic: './images/shop_images/item10.jpg',
                        name: '黃金典雅禮盒4入',
                        price: '480',
                        text: '這款黃金典雅禮盒內含精選巧克力，包裝豪華，適合送禮自用皆宜，展現品味與高貴。'
                    },
                    {
                        id: '11',
                        counts: '4',
                        pic: './images/shop_images/item11.jpg',
                        name: '手工奢華巧克力禮盒4入',
                        price: '300',
                        text: '每顆巧克力皆由大師手工製作，結合頂級原料，讓您體驗無可比擬的奢華口感。'
                    },
                    {
                        id: '12',
                        counts: '4',
                        pic: './images/shop_images/item12.jpg',
                        name: '生日星河禮盒4入',
                        price: '380',
                        text: '璀璨星河禮盒帶來星光般的美麗，內含精緻巧克力，每一口都充滿浪漫與驚喜。',
                        fes: 'birthday'
                    },
                    {
                        id: '13',
                        counts: '6',
                        pic: './images/shop_images/item13.jpg',
                        name: '璀璨七夕-情人節禮盒',
                        price: '800',
                        text: '專為情人節設計的璀璨禮盒，展現愛意，巧克力的每一口都彷彿融化在心中。',
                        fes: 'valentines'
                    },
                    {
                        id: '14',
                        counts: '6',
                        pic: './images/shop_images/item14.jpg',
                        name: '熱戀之吻-情人節禮盒',
                        price: '980',
                        text: '熱戀之吻巧克力禮盒，特別為情人節打造，甜美的巧克力表達最深情的告白。',
                        fes: 'valentines'
                    },
                    {
                        id: '15',
                        counts: '6',
                        pic: './images/shop_images/item15.jpg',
                        name: '生日快樂-慶生禮盒',
                        price: '980',
                        text: '生日巧克力禮盒，特別為慶祝生日打造，甜美的巧克力表達最真誠的祝福。',
                        fes: 'birthday'
                    }
                ];


                // 創建狀態來管理篩選條件
                const [filteredItems, setFilteredItems] = React.useState(items);
                const [selectedPriceRange, setSelectedPriceRange] = React.useState(null);
                const [selecteCountsRange, setSelectedCountsRange] = React.useState(null);
                const [selecteFestivalRange, setSelectedFestivalRange] = React.useState(null);
                const [selectedPermutation, setSelectedPermutation] = React.useState(null);


                // 創建狀態來控制每個下拉菜單的顯示狀態
                const [showFestivalDropdown, setShowFestivalDropdown] = React.useState(false);
                const [showCountsDropdown, setShowCountsDropdown] = React.useState(false);
                const [showPriceDropdown, setShowPriceDropdown] = React.useState(false);
                const [showPermutationDropdown, setShowPermutationDropdown] = React.useState(false);
                const handleFestivalFilter = (range) => {
                    setSelectedFestivalRange(range);
                    const filtered = items.filter(item => {
                        const fes = item.fes;
                        switch (range) {
                            case 'valentines':
                                return fes === 'valentines';
                            case 'birthday':
                                return fes === 'birthday';
                            case 'graduation':
                                return fes === 'graduation';
                            case 'otherDay':
                                return fes === 'otherDay';
                            default:
                                return true;
                        }
                    });
                    setFilteredItems(filtered);
                };
                const handlePriceFilter = (range) => {
                    setSelectedPriceRange(range);
                    const filtered = items.filter(item => {
                        const price = parseInt(item.price.replace(',', '').trim());
                        switch (range) {
                            case 'below500':
                                return price < 501;
                            case 'below1000':
                                return price < 1001;
                            case 'below2000':
                                return price < 2001;
                            case 'above2000':
                                return price > 2000;
                            default:
                                return true;
                        }
                    });
                    setFilteredItems(filtered);
                };
                const handleCountsFilter = (range) => {
                    console.log('Selected counts range:', range); // 確認選擇的篩選條件
                    setSelectedCountsRange(range);
                    const filtered = items.filter(item => {
                        const counts = parseInt(item.counts.replace(',', '').trim());
                        console.log('Item counts:', counts); // 確認每個 item 的 counts
                        switch (range) {
                            case 'are4':
                                return counts === 4;
                            case 'are6':
                                return counts === 6;
                            case 'are12':
                                return counts === 12;
                            case 'are24':
                                return counts === 24;
                            default:
                                return true;
                        }
                    });
                    setFilteredItems(filtered);
                };


                // 函數：切換下拉菜單的顯示狀態
                //    const toggleDropdown = (dropdownSetter) => {
                //       dropdownSetter(prevState => !prevState);
                // };
                /*     const toggleDropdown = (dropdown) => {
                        switch (dropdown) {
                            case 'price':
                                setShowPriceDropdown(prevState => !prevState);
                        break;
                        case 'counts':
                                setShowCountsDropdown(prevState => !prevState);
                        break;
                        case 'festival':
                                setShowFestivalDropdown(prevState => !prevState);
                        break;
                        case 'permutation':
                                setShowPermutationDropdown(prevState => !prevState);
                        break;
                        default:
                        break;
                        }
                    }; */

                const toggleDropdown = (dropdown, show) => {
                    switch (dropdown) {
                        case 'price':
                            setShowPriceDropdown(show);
                            break;
                        case 'counts':
                            setShowCountsDropdown(show);
                            break;
                        case 'festival':
                            setShowFestivalDropdown(show);
                            break;
                        case 'permutation':
                            setShowPermutationDropdown(show);
                            break;
                        default:
                            break;
                    }
                };
                const sortItems = (permutation) => {
                    let sortedItems = [...filteredItems]; // 創建 `filteredItems` 的副本以進行排序

                    switch (permutation) {
                        case 'popular':
                            // 根據熱門排序，這裡假設 items 本身沒有熱門排序，根據需求可以更改
                            sortedItems.sort((a, b) => a.id - b.id); // 替換為實際的熱門排序邏輯
                            break;
                        case 'recommended':
                            // 根據推薦排序
                            sortedItems.sort((a, b) => b.id - a.id); // 替換為實際的推薦排序邏輯
                            break;
                        case 'priceAsc':
                            sortedItems.sort((a, b) => parseInt(a.price.replace(',', '')) - parseInt(b.price.replace(',', '')));
                            break;
                        case 'priceDesc':
                            sortedItems.sort((a, b) => parseInt(b.price.replace(',', '')) - parseInt(a.price.replace(',', '')));
                            break;
                        default:
                            break;
                    }

                    setFilteredItems(sortedItems);
                };
                const handlePermutationFilter = (option) => {
                    setSelectedPermutation(option);
                    sortItems(option); // 根據選擇的 permutation 進行排序
                };



                return (<>
                    <section id="items_content">
                        <ShopFilter
                            handlePermutationFilter={handlePermutationFilter}
                            handleFestivalFilter={handleFestivalFilter}
                            handleCountsFilter={handleCountsFilter}
                            handlePriceFilter={handlePriceFilter}
                            toggleDropdown={toggleDropdown}
                            showPriceDropdown={showPriceDropdown}
                            showCountsDropdown={showCountsDropdown}
                            showFestivalDropdown={showFestivalDropdown}
                            showPermutationDropdown={showPermutationDropdown}
                        />

                        <div className="items_list">
                            {/*items => filteredItems*/}
                            {filteredItems.map((item) => {
                                return (
                                    <Item key={item.id}
                                        id={item.id}
                                        pic={item.pic}
                                        name={item.name}
                                        price={item.price}
                                        text={item.text} />
                                )
                            })
                            }

                        </div>
                        <div className="change_page">
                            <div id="pages_num">
                                <a href="./shop.html">1</a>
                                <a href="#">2</a>
                                <a href="#">3</a>
                            </div>
                            <div className="next_pages">
                                <a href="#" className="next_page_text"><img src="./images/footer_btn_nextpage.svg" alt="" /></a>
                            </div>
                        </div>
                    </section>
                    <Footer />

                </>)
            };
            ReactDOM.createRoot(document.getElementById('root')).render(<App />);
        </script>


        <!-- <div class="item_wrap">
                        <a class="item" href="#">
                            <div class="item_pic"> <img src="./images/shop_images/item9.jpg" alt=""></div>
                            <div class="item_name">麋鹿聖誕-巧克力禮盒</div>
                            <div class="item_price">NT 3,000</div>
                            <div class="item_text">聖誕節限定巧克力禮盒，精緻設計與美味巧克力，增添節日的歡樂與喜悅。</div>
                        </a>
                    </div> -->

        </div>





    </main>
    <!-- 引用Footer元件 -->
    <script type="text/babel" src="./Footer.jsx"></script>
    <link rel="stylesheet" href="./css/Footer.css">
    <!-- js -->
    <!-- 可以使用套件給的 or官網的最新版 但只能擇一使用 -->
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    <script src="./js/shop.js"></script>
    <!-- 引用swiper -->
    <script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>

    <script src="./js/Menu.js"></script>
</body>

</html>